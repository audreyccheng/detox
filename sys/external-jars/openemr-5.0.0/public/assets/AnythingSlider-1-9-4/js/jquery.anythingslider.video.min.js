/*
 * AnythingSlider Video Controller 1.5.1 beta minified
 * for AnythingSlider v1.6+
 * By Rob Garrison (aka Mottie & Fudgey)
 * Dual licensed under the MIT and GPL licenses.
 */
;(function(d){d.fn.anythingSliderVideo=function(b){var c={videoId:"asvideo",wmode:"opaque",youtubeAutoLoad:!0,youtubeParams:{modestbranding:1,iv_load_policy:3,fs:1}};return this.each(function(){var a,e,h,g,f=d(this).data("AnythingSlider");if(f){a=f.video={};a.options=d.extend({},c,b);a.hasSwfo="undefined"!==typeof swfobject&&swfobject.hasOwnProperty("embedSWF")&&"function"===typeof swfobject.embedSWF&&swfobject.hasFlashPlayerVersion("1");a.list={};a.hasVid=!1;a.hasEmbed=!1;a.services=d.fn.anythingSliderVideo.services; a.hasEmbedCount=0;a.hasiframeCount=0;a.$items=f.$items.filter(":not(.cloned)");for(h in a.services)"string"===typeof h&&(g=a.services[h].selector,a.$items.find(g).each(function(){e=d(this);e.attr("id",a.options.videoId+d.fn.anythingSliderVideo.videoIndex);a.list[d.fn.anythingSliderVideo.videoIndex]={id:a.options.videoId+d.fn.anythingSliderVideo.videoIndex++,panel:e.closest(".panel")[0],service:h,selector:g,status:-1};a.hasVid=!0;g.match("embed|object")?(a.hasEmbed=!0,a.hasEmbedCount++):g.match("iframe")&& a.hasiframeCount++}));d.each(a.list,function(b,c){var l,e,h,g,m=d(c.panel).find(c.selector),j=a.services[c.service],p=j.api&&j.api.initParam||"",n=j.api&&j.api.playerId||"";a.hasEmbed&&a.hasSwfo&&c.selector.match("embed|object")?m.each(function(){l=d(this);e="OBJECT"===d(this).parent()[0].tagName?d(this).parent():d(this);h="EMBED"===e[0].tagName?e.attr("src"):e.find("embed").attr("src")||e.children().filter("[name=movie]").attr("value");g=d.extend(!0,{},{flashvars:null,params:{allowScriptAccess:"always", wmode:a.options.wmode||f.options.addWmodeToObject,allowfullscreen:!0},attr:{"class":e.attr("class"),style:e.attr("style"),"data-url":h}},j.embedOpts);e.wrap('<div id="'+c.id+'"></div>');swfobject.embedSWF(h+p+(n?n+c.id:""),c.id,e.attr("width"),e.attr("height"),"10",null,g.flashvars,g.params,g.attr,function(){j.hasOwnProperty("init")&&j.init(f,l,b);b>=a.hasEmbedCount&&f.$el.trigger("swf_completed",f)})}):c.selector.match("iframe")&&m.each(function(){var a=d(this);j.hasOwnProperty("init")&&j.init(f, a,b)})});a.gup=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=RegExp("[\\?&]"+a+"=([^&#]*)").exec(b||window.location.href);return null===c?"":c[1]};a.postMsg=function(a,b){var c=d("#"+b);c.length&&c[0].contentWindow.postMessage(a,c.attr("src").split("?")[0])};a.message=function(c){if(c.data&&!/infoDelivery/g.test(c.data)){var b=d.parseJSON(c.data);d.each(a.list,function(c){a.services[a.list[c].service].hasOwnProperty("message")&&a.services[a.list[c].service].message(f,b)})}}; a.control=function(c){var b,e=a.list,h="pause"===c?f.$lastPage[0]:f.$currentPage[0],g=!1;for(b=0;b<d.fn.anythingSliderVideo.videoIndex;b++)e[b]&&(e[b].panel===h&&a.services[e[b].service].hasOwnProperty(c))&&(g=a.services[e[b].service][c](f,d("#"+e[b].id),b));return g};a.bindFrames=function(b){window.addEventListener?window.addEventListener(b,a.message,!1):window.attachEvent(/^on/.test(b)?b:"on"+b,a.message,!1)};a.hasiframeCount&&a.bindFrames("message");f.$el.bind("slide_init",function(){a.control("pause")}).bind("slide_complete", function(){a.control("cont")});a.isVideoPlayingOrig=f.options.isVideoPlaying;f.options.isVideoPlaying=function(){return a.control("isPlaying")||a.isVideoPlayingOrig&&a.isVideoPlayingOrig()};if("function"===typeof a.options.onVideoInitialized)a.options.onVideoInitialized(f)}})};d.fn.anythingSliderVideo.videoIndex=0;d.fn.anythingSliderVideo.services={video:{selector:"video",cont:function(b,c){b.options.resumeOnVisible&&(c.length&&c[0].paused&&0<c[0].currentTime&&!c[0].ended)&&c[0].play()},pause:function(){d("video").each(function(){"undefined"!== typeof this.pause&&this.pause()})},isPlaying:function(b,c){return c.length&&"undefined"!==typeof c[0].pause&&!c[0].paused&&!c[0].ended?!0:!1}},vimeo1:{selector:"iframe[src*=vimeo]",init:function(b,c){var a=c.attr("src");c.attr("src",function(d,h){return h+(a.match(/\?/g)?"":"?")+"&wmode="+(b.video.options.wmode||b.options.addWmodeToObject)+"&api=1&player_id="+c[0].id})},cont:function(b,c,a){b.options.resumeOnVisible&&"pause"===b.video.list[a].status&&b.video.postMsg('{"method":"play"}',c[0].id)}, pause:function(b){d("iframe[src*=vimeo]").each(function(){b.video.postMsg('{"method":"pause"}',this.id)})},message:function(b,c){var a,d=c.player_id||"";""!==d&&(a=d.replace(b.video.options.videoId,""),"ready"===c.event&&(b.video.postMsg('{"method":"addEventListener","value":"play"}',d),b.video.postMsg('{"method":"addEventListener","value":"pause"}',d),b.video.postMsg('{"method":"addEventListener","value":"finish"}',d)),b.video.list[a]&&(b.video.list[a].status=c.event))},isPlaying:function(b,c,a){return"play"=== b.video.list[a].status?!0:!1}},vimeo2:{selector:"object[data-url*=vimeo], embed[src*=vimeo]",embedOpts:{flashvars:{api:1}},cont:function(b,c){b.options.resumeOnVisible&&"function"===typeof c[0].api_play&&(c[0].api_paused()&&0!==c[0].api_getCurrentTime()&&2<c[0].api_getDuration()-c[0].api_getCurrentTime())&&c[0].api_play()},pause:function(){d("object[data-url*=vimeo], embed[src*=vimeo]").each(function(){var b="EMBED"===this.tagName?d(this).parent()[0]:this;"function"===typeof b.api_pause&&b.api_pause()})}, isPlaying:function(b,c){return"function"===typeof c[0].api_paused&&!c[0].api_paused()?!0:!1}},youtube1:{selector:"iframe[src*=youtube]",init:function(b,c,a){!d.fn.anythingSliderVideo.youTubeLoaded&&b.video.options.youtubeAutoLoad&&d.getScript("http://www.youtube.com/iframe_api",function(){d.fn.anythingSliderVideo.youTubeLoaded=!0});var e=0,h=setInterval(function(){if(d.fn.anythingSliderVideo.youTubeReady){var g=c[0].id,f=c.attr("src").split("embed/")[1],k=b.video.options.youtubeParams;k.wmode=b.video.options.wmode|| b.options.addWmodeToObject||"opaque";c.wrap('<div id="'+g+'"/>').attr("id","");b.video.list[a].player=new YT.Player(g,{height:"100%",width:"100%",videoId:f,playerVars:k,events:{onReady:function(c){b.video.list[a].status=c.data},onStateChange:function(c){b.video.list[a].status=c.data}}});clearInterval(h)}60<++e&&clearInterval(h)},1E3)},cont:function(b,c,a){b.options.resumeOnVisible&&2===b.video.list[a].status&&b.video.list[a].player&&b.video.list[a].player.playVideo()},pause:function(b,c,a){b.video.list[a].player&& b.video.list[a].player.pauseVideo()},isPlaying:function(b,c,a){b=b.video.list[a].status;return 1===b||2<b?!0:!1}},youtube2:{selector:"object[data-url*=youtube], embed[src*=youtube]",api:{initParam:"&enablejsapi=1",playerId:"&iv_load_policy=3&version=3&playerapiid="},cont:function(b,c){b.options.resumeOnVisible&&c.length&&("function"===typeof c[0].getPlayerState&&0<c[0].getPlayerState())&&c[0].playVideo()},pause:function(){d("object[data-url*=youtube], embed[src*=youtube]").each(function(){var b="EMBED"=== this.tagName?d(this).parent()[0]:this;"function"===typeof b.getPlayerState&&0<b.getPlayerState()&&b.pauseVideo()})},isPlaying:function(b,c){return"function"===typeof c[0].getPlayerState&&(1===c[0].getPlayerState()||2<c[0].getPlayerState())?!0:!1}}}})(jQuery);function onYouTubeIframeAPIReady(){$.fn.anythingSliderVideo.youTubeReady=!0};
